<html><head><base href="https://networktopology.io/"><meta charset="UTF-8"><title>網路拓樸圖產生器</title><style>body{font-family:'Microsoft JhengHei', Arial, sans-serif;line-height:1.6;color:#333;max-width:1200px;margin:0 auto;padding:20px;transition:background-color 0.3s,color 0.3s}body.dark-mode{background-color:#1a1a1a;color:#f0f0f0}h1,h2,h3,h4{color:#2c3e50}body.dark-mode h1,body.dark-mode h2,body.dark-mode h3,body.dark-mode h4{color:#f0f0f0}textarea{width:100%;height:100px;margin-bottom:10px;font-family:monospace}button{padding:10px 20px;background-color:#3498db;color:white;border:none;cursor:pointer;margin-right:10px;border-radius:5px;transition:background-color 0.3s}button:hover{background-color:#2980b9}#topology{width:100%;height:600px;border:1px solid #ddd;margin-top:20px;border-radius:5px}body.dark-mode #topology{border-color:#444}.device-input{border:1px solid #ddd;padding:20px;margin-bottom:20px;border-radius:10px;background-color:#f9f9f9;box-shadow:0 2px 5px rgba(0,0,0,0.1)}body.dark-mode .device-input{background-color:#2a2a2a;border-color:#444;box-shadow:0 2px 5px rgba(255,255,255,0.1)}.options{margin-top:20px;display:flex;flex-wrap:wrap;gap:10px}.hidden{display:none}.interface-input,.route-input{display:flex;margin-bottom:10px;align-items:center;gap:5px}.interface-input input,.route-input input{flex:1;padding:8px;border:1px solid #ddd;border-radius:4px}body.dark-mode .interface-input input,body.dark-mode .route-input input{background-color:#333;color:#f0f0f0;border-color:#555}.add-btn{background-color:#2ecc71;color:white;border:none;padding:8px 15px;cursor:pointer;border-radius:4px;transition:background-color 0.3s}.add-btn:hover{background-color:#27ae60}.remove-btn{background-color:#e74c3c;color:white;border:none;padding:8px 15px;cursor:pointer;border-radius:4px;transition:background-color 0.3s}.remove-btn:hover{background-color:#c0392b}.device-name,.device-mgmt,.device-username,.device-password,.device-type{width:100%;margin-bottom:10px;padding:8px;border:1px solid #ddd;border-radius:4px}body.dark-mode .device-name,body.dark-mode .device-mgmt,body.dark-mode .device-username,body.dark-mode .device-password,body.dark-mode .device-type{background-color:#333;color:#f0f0f0;border-color:#555}.import-export{margin-top:20px;display:flex;justify-content:space-between}.device-header{display:flex;justify-content:space-between;align-items:center;margin-bottom:15px}.device-body{display:flex;flex-direction:column;gap:20px}.interfaces,.routes{margin-top:15px;padding:10px;background-color:#fff;border-radius:5px;box-shadow:0 1px 3px rgba(0,0,0,0.1)}body.dark-mode .interfaces,body.dark-mode .routes{background-color:#333;box-shadow:0 1px 3px rgba(255,255,255,0.1)}.option-item{display:flex;align-items:center;gap:5px}#language-select{margin-left:auto;padding:5px;border-radius:5px;border:1px solid #ddd}body.dark-mode #language-select{background-color:#333;color:#f0f0f0;border-color:#555}.dark-mode-switch{position:relative;display:inline-block;width:60px;height:34px}.dark-mode-switch input{opacity:0;width:0;height:0}.dark-mode-slider{position:absolute;cursor:pointer;top:0;left:0;right:0;bottom:0;background-color:#ccc;transition:.4s;border-radius:34px}.dark-mode-slider:before{position:absolute;content:"";height:26px;width:26px;left:4px;bottom:4px;background-color:white;transition:.4s;border-radius:50%}input:checked+.dark-mode-slider{background-color:#2196F3}input:checked+.dark-mode-slider:before{transform:translateX(26px)}.header-container{display:flex;justify-content:space-between;align-items:center}#editModal{display:none;position:fixed;z-index:1000;left:0;top:0;width:100%;height:100%;overflow:auto;background-color:rgba(0,0,0,0.4)}.modal-content{background-color:#fefefe;margin:15% auto;padding:20px;border:1px solid #888;width:80%;max-width:500px}body.dark-mode .modal-content{background-color:#333;color:#f0f0f0}.close{color:#aaa;float:right;font-size:28px;font-weight:bold;cursor:pointer}.close:hover,.close:focus{color:#000;text-decoration:none;cursor:pointer}body.dark-mode .close:hover,body.dark-mode .close:focus{color:#fff}#editForm textarea{width:100%;height:100px;margin-bottom:10px}#saveChanges{background-color:#4CAF50;color:white;padding:10px 15px;border:none;cursor:pointer;width:100%}#saveChanges:hover{background-color:#45a049}</style><script src="https://cdnjs.cloudflare.com/ajax/libs/vis-network/9.1.2/dist/vis-network.min.js"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/html2canvas/1.3.2/html2canvas.min.js"></script></head><body><div class="header-container"><h1 id="title">網路拓樸圖產生器</h1><div style="display:flex;align-items:center;gap:10px"><label class="dark-mode-switch"><input type="checkbox" id="darkModeToggle"><span class="dark-mode-slider"></span></label><select id="language-select"><option value="zh">中文</option><option value="en">English</option></select></div></div><p id="description">輸入您的網路設備資訊，我們將為您生成詳細的網路拓樸圖。</p><div id="deviceInputs"></div><button id="addDevice">添加新設備</button><button id="generateTopology">生成拓樸圖</button><button id="downloadImage" style="display:none;">下載圖片</button><button id="downloadSVG" style="display:none;">下載SVG</button><div class="options"><div class="option-item"><input type="checkbox" id="showIPs" checked><label for="showIPs" id="showIPsLabel">顯示IP地址</label></div><div class="option-item"><input type="checkbox" id="showInterfaces" checked><label for="showInterfaces" id="showInterfacesLabel">顯示介面名稱</label></div><div class="option-item"><input type="checkbox" id="showNetworks" checked><label for="showNetworks" id="showNetworksLabel">顯示網段</label></div><div class="option-item"><input type="checkbox" id="showCredentials"><label for="showCredentials" id="showCredentialsLabel">顯示帳號密碼</label></div><div class="option-item"><input type="checkbox" id="showServerIcons"><label for="showServerIcons" id="showServerIconsLabel">顯示伺服器圖示</label></div></div><div id="topology"></div><div id="legend" class="hidden"><h3 id="legendTitle">圖例</h3><svg width="200" height="120"><rect x="10" y="10" width="20" height="20" fill="#97C2FC"></rect><text x="40" y="25" id="legendDevice">設備</text><rect x="10" y="40" width="20" height="20" fill="#2ecc71"></rect><text x="40" y="55" id="legendServer">伺服器</text><circle cx="20" cy="80" r="10" fill="#FFFF00"></circle><text x="40" y="85" id="legendNetwork">網段</text><line x1="10" y1="100" x2="30" y2="100" stroke="#848484" stroke-width="2"></line><text x="40" y="105" id="legendConnection">連接</text><line x1="10" y1="120" x2="30" y2="120" stroke="#848484" stroke-width="2" stroke-dasharray="5,5"></line><text x="40" y="125" id="legendRoute">路由</text></svg></div><div class="import-export"><button id="exportConfig">匯出設定</button><input type="file" id="importConfig" accept=".json"><button id="importConfigBtn">匯入設定</button></div><div id="editModal" class="modal"><div class="modal-content"><span class="close">&times;</span><h2 id="editModalTitle">編輯節點</h2><form id="editForm"><textarea id="editText"></textarea><button type="submit" id="saveChanges">保存更改</button></form></div></div><script>let deviceCount=0;const deviceInputs=document.getElementById('deviceInputs');const addDeviceBtn=document.getElementById('addDevice');const generateBtn=document.getElementById('generateTopology');const downloadImageBtn=document.getElementById('downloadImage');const downloadSVGBtn=document.getElementById('downloadSVG');const topology=document.getElementById('topology');const legend=document.getElementById('legend');const exportConfigBtn=document.getElementById('exportConfig');const importConfigInput=document.getElementById('importConfig');const importConfigBtn=document.getElementById('importConfigBtn');const showCredentialsCheckbox=document.getElementById('showCredentials');const showServerIconsCheckbox=document.getElementById('showServerIcons');const languageSelect=document.getElementById('language-select');const darkModeToggle=document.getElementById('darkModeToggle');let currentLanguage='zh';const translations={zh:{title:'網路拓樸圖產生器',description:'輸入您的網路設備資訊，我們將為您生成詳細的網路拓樸圖。',addDevice:'添加新設備',generateTopology:'生成拓樸圖',downloadImage:'下載圖片',downloadSVG:'下載SVG',showIPs:'顯示IP地址',showInterfaces:'顯示介面名稱',showNetworks:'顯示網段',showCredentials:'顯示帳號密碼',showServerIcons:'顯示伺服器圖示',legendTitle:'圖例',legendDevice:'設備',legendServer:'伺服器',legendNetwork:'網段',legendConnection:'連接',legendRoute:'路由',exportConfig:'匯出設定',importConfig:'匯入設定',device:'設備',interfaceSettings:'介面設定',routeTable:'路由表',addInterface:'添加介面',addRoute:'添加路由',remove:'移除',interfaceName:'介面名稱',ipAddress:'IP地址',subnetMask:'子網路遮罩',destinationNetwork:'目的網路',nextHop:'下一跳',editModalTitle:'編輯節點',saveChanges:'保存更改',},en:{title:'Network Topology Generator',description:'Enter your network device information, and we will generate a detailed network topology diagram for you.',addDevice:'Add New Device',generateTopology:'Generate Topology',downloadImage:'Download Image',downloadSVG:'Download SVG',showIPs:'Show IP Addresses',showInterfaces:'Show Interface Names',showNetworks:'Show Networks',showCredentials:'Show Credentials',showServerIcons:'Show Server Icons',legendTitle:'Legend',legendDevice:'Device',legendServer:'Server',legendNetwork:'Network',legendConnection:'Connection',legendRoute:'Route',exportConfig:'Export Config',importConfig:'Import Config',device:'Device',interfaceSettings:'Interface Settings',routeTable:'Route Table',addInterface:'Add Interface',addRoute:'Add Route',remove:'Remove',interfaceName:'Interface Name',ipAddress:'IP Address',subnetMask:'Subnet Mask',destinationNetwork:'Destination Network',nextHop:'Next Hop',editModalTitle:'Edit Node',saveChanges:'Save Changes',}};addDeviceBtn.addEventListener('click',()=>addDevice());generateBtn.addEventListener('click',generateTopology);downloadImageBtn.addEventListener('click',downloadImage);downloadSVGBtn.addEventListener('click',downloadSVG);exportConfigBtn.addEventListener('click',exportConfig);importConfigBtn.addEventListener('click',()=>importConfigInput.click());importConfigInput.addEventListener('change',importConfig);showCredentialsCheckbox.addEventListener('change',generateTopology);showServerIconsCheckbox.addEventListener('change',generateTopology);languageSelect.addEventListener('change',changeLanguage);darkModeToggle.addEventListener('change',toggleDarkMode);function addDevice(name='',mgmt='',username='',password='',type='Firewall'){deviceCount++;const newDevice=document.createElement('div');newDevice.className='device-input';newDevice.innerHTML=`<div class="device-header"><h3>${translations[currentLanguage].device} ${deviceCount}</h3><button class="remove-btn" onclick="this.closest('.device-input').remove()">${translations[currentLanguage].remove}</button></div><div class="device-body"><div><input type="text" class="device-name" value="${name||`${translations[currentLanguage].device} ${deviceCount}`}" placeholder="${translations[currentLanguage].device}"><select class="device-type"><option value="Firewall" ${type==='Firewall'?'selected':''}>Firewall</option><option value="Router" ${type==='Router'?'selected':''}>Router</option><option value="Switch" ${type==='Switch'?'selected':''}>Switch</option><option value="AP" ${type==='AP'?'selected':''}>AP</option><option value="Server" ${type==='Server'?'selected':''}>Server</option></select><input type="text" class="device-mgmt" value="${mgmt}" placeholder="${translations[currentLanguage].interfaceName}"><input type="text" class="device-username" value="${username}" placeholder="${translations[currentLanguage].username}"><input type="password" class="device-password" value="${password}" placeholder="${translations[currentLanguage].password}"></div><div class="interfaces"><h4>${translations[currentLanguage].interfaceSettings}</h4></div><div class="routes"><h4>${translations[currentLanguage].routeTable}</h4></div></div>`;deviceInputs.appendChild(newDevice);const interfacesDiv=newDevice.querySelector('.interfaces');const routesDiv=newDevice.querySelector('.routes');const addInterfaceBtn=document.createElement('button');addInterfaceBtn.className='add-btn';addInterfaceBtn.textContent=translations[currentLanguage].addInterface;addInterfaceBtn.onclick=()=>addInterface(interfacesDiv);interfacesDiv.appendChild(addInterfaceBtn);const addRouteBtn=document.createElement('button');addRouteBtn.className='add-btn';addRouteBtn.textContent=translations[currentLanguage].addRoute;addRouteBtn.onclick=()=>addRoute(routesDiv);routesDiv.appendChild(addRouteBtn);addInterface(interfacesDiv);addRoute(routesDiv)}function addInterface(interfacesDiv,name='',ip='',subnet=''){const newInterface=document.createElement('div');newInterface.className='interface-input';newInterface.innerHTML=`<input type="text" placeholder="${translations[currentLanguage].interfaceName}" class="interface-name" value="${name}"><input type="text" placeholder="${translations[currentLanguage].ipAddress}" class="interface-ip" value="${ip}"><input type="text" placeholder="${translations[currentLanguage].subnetMask}" class="interface-subnet" value="${subnet}"><button class="remove-btn" onclick="removeInput(this)">${translations[currentLanguage].remove}</button>`;interfacesDiv.insertBefore(newInterface,interfacesDiv.lastElementChild)}function addRoute(routesDiv,dest='',mask='',nextHop=''){const newRoute=document.createElement('div');newRoute.className='route-input';newRoute.innerHTML=`<input type="text" placeholder="${translations[currentLanguage].destinationNetwork}" class="route-dest" value="${dest}"><input type="text" placeholder="${translations[currentLanguage].subnetMask}" class="route-mask" value="${mask}"><input type="text" placeholder="${translations[currentLanguage].nextHop}" class="route-nexthop" value="${nextHop}"><button class="remove-btn" onclick="removeInput(this)">${translations[currentLanguage].remove}</button>`;routesDiv.insertBefore(newRoute,routesDiv.lastElementChild)}function removeInput(btn){btn.parentElement.remove()}function ipToNetwork(ip,subnet){const ipParts=ip.split('.').map(Number);const subnetParts=subnet.split('.').map(Number);const networkParts=ipParts.map((part,index)=>part&subnetParts[index]);return networkParts.join('.')}let network;function generateTopology(){const devices=document.querySelectorAll('.device-input');const nodes=new vis.DataSet();const edges=new vis.DataSet();const networks=new Set();const ipToDeviceMap=new Map();const showCredentials=document.getElementById('showCredentials').checked;const showServerIcons=document.getElementById('showServerIcons').checked;devices.forEach((device,index)=>{const deviceName=device.querySelector('.device-name').value;const deviceType=device.querySelector('.device-type').value;const mgmtInterface=device.querySelector('.device-mgmt').value;const username=device.querySelector('.device-username').value;const password=device.querySelector('.device-password').value;const interfaces=device.querySelectorAll('.interface-input');const routes=device.querySelectorAll('.route-input');let deviceInterfaces=[];interfaces.forEach(int=>{const intName=int.querySelector('.interface-name').value;const ip=int.querySelector('.interface-ip').value;const subnet=int.querySelector('.interface-subnet').value;if(ip&&subnet){const network=ipToNetwork(ip,subnet);deviceInterfaces.push({name:intName,ip:ip,subnet:subnet,network:network});networks.add(network);ipToDeviceMap.set(ip,deviceName)}});if(deviceInterfaces.length>0){let label=`${deviceName}\n${deviceType}\n${deviceInterfaces[0].ip}`;if(showCredentials){label+=`\n${translations[currentLanguage].interfaceName}: ${mgmtInterface}\n${translations[currentLanguage].username}: ${username}\n${translations[currentLanguage].password}: ${password}`}let color=deviceType==='Server'?'#2ecc71':'#97C2FC';nodes.add({id:deviceName,label:label,group:'device',shape:'box',color:color});deviceInterfaces.forEach(int=>{if(document.getElementById('showNetworks').checked&&int.network&&int.network!=='...'){edges.add({from:deviceName,to:`network_${int.network}`,label:int.name})}})}routes.forEach(route=>{const dest=route.querySelector('.route-dest').value;const mask=route.querySelector('.route-mask').value;const nextHop=route.querySelector('.route-nexthop').value;if(nextHop&&nextHop!=='0.0.0.0'){const targetDevice=ipToDeviceMap.get(nextHop);if(targetDevice){edges.add({from:deviceName,to:targetDevice,arrows:'to',dashes:true,label:translations[currentLanguage].route})}}})});if(document.getElementById('showNetworks').checked){networks.forEach(network=>{if(network&&network!=='...'&&network!=='0.0.0.0'){nodes.add({id:`network_${network}`,label:`${translations[currentLanguage].network}\n${network}`,group:'network',shape:'circle'})}})}const data={nodes:nodes,edges:edges};const options={groups:{device:{},network:{color:'#FFFF00'}},physics:{enabled:true,barnesHut:{gravitationalConstant:-2000,centralGravity:0.3,springLength:95,springConstant:0.04,damping:0.09,avoidOverlap:0.1},},};network=new vis.Network(topology,data,options);legend.classList.remove('hidden');downloadImageBtn.style.display='inline-block';downloadSVGBtn.style.display='inline-block';network.on("doubleClick",function(params){if(params.nodes.length>0){const nodeId=params.nodes[0];const node=nodes.get(nodeId);openEditModal(node)}})}function downloadImage(){html2canvas(document.querySelector("#topology")).then(canvas=>{const link=document.createElement('a');link.download='network_topology.png';link.href=canvas.toDataURL();link.click()})}function downloadSVG(){const svgElement=topology.querySelector('svg');if(svgElement){const svgData=new XMLSerializer().serializeToString(svgElement);const svgBlob=new Blob([svgData],{type:"image/svg+xml;charset=utf-8"});const svgUrl=URL.createObjectURL(svgBlob);const downloadLink=document.createElement("a");downloadLink.href=svgUrl;downloadLink.download="network_topology.svg";document.body.appendChild(downloadLink);downloadLink.click();document.body.removeChild(downloadLink);URL.revokeObjectURL(svgUrl)}else{console.error('SVG element not found')}}function exportConfig(){const devices=document.querySelectorAll('.device-input');const config=[];devices.forEach(device=>{const deviceName=device.querySelector('.device-name').value;const deviceType=device.querySelector('.device-type').value;const mgmtInterface=device.querySelector('.device-mgmt').value;const username=device.querySelector('.device-username').value;const password=device.querySelector('.device-password').value;const interfaces=device.querySelectorAll('.interface-input');const routes=device.querySelectorAll('.route-input');const deviceConfig={name:deviceName,type:deviceType,mgmtInterface:mgmtInterface,username:username,password:password,interfaces:[],routes:[]};interfaces.forEach(int=>{deviceConfig.interfaces.push({name:int.querySelector('.interface-name').value,ip:int.querySelector('.interface-ip').value,subnet:int.querySelector('.interface-subnet').value})});routes.forEach(route=>{deviceConfig.routes.push({dest:route.querySelector('.route-dest').value,mask:route.querySelector('.route-mask').value,nextHop:route.querySelector('.route-nexthop').value})});config.push(deviceConfig)});const blob=new Blob([JSON.stringify(config,null,2)],{type:'application/json'});const url=URL.createObjectURL(blob);const a=document.createElement('a');a.href=url;a.download='network_config.json';document.body.appendChild(a);a.click();document.body.removeChild(a);URL.revokeObjectURL(url)}function importConfig(event){const file=event.target.files[0];if(file){const reader=new FileReader();reader.onload=function(e){const config=JSON.parse(e.target.result);deviceInputs.innerHTML='';config.forEach(device=>{addDevice(device.name,device.mgmtInterface,device.username,device.password,device.type);const newDevice=deviceInputs.lastElementChild;const interfacesDiv=newDevice.querySelector('.interfaces');const routesDiv=newDevice.querySelector('.routes');device.interfaces.forEach(int=>{addInterface(interfacesDiv,int.name,int.ip,int.subnet)});device.routes.forEach(route=>{addRoute(routesDiv,route.dest,route.mask,route.nextHop)})})};reader.readAsText(file)}}function changeLanguage(){currentLanguage=languageSelect.value;document.getElementById('title').textContent=translations[currentLanguage].title;document.getElementById('description').textContent=translations[currentLanguage].description;document.getElementById('addDevice').textContent=translations[currentLanguage].addDevice;document.getElementById('generateTopology').textContent=translations[currentLanguage].generateTopology;document.getElementById('downloadImage').textContent=translations[currentLanguage].downloadImage;document.getElementById('downloadSVG').textContent=translations[currentLanguage].downloadSVG;document.getElementById('showIPsLabel').textContent=translations[currentLanguage].showIPs;document.getElementById('showInterfacesLabel').textContent=translations[currentLanguage].showInterfaces;document.getElementById('showNetworksLabel').textContent=translations[currentLanguage].showNetworks;document.getElementById('showCredentialsLabel').textContent=translations[currentLanguage].showCredentials;document.getElementById('showServerIconsLabel').textContent=translations[currentLanguage].showServerIcons;document.getElementById('legendTitle').textContent=translations[currentLanguage].legendTitle;document.getElementById('legendDevice').textContent=translations[currentLanguage].legendDevice;document.getElementById('legendServer').textContent=translations[currentLanguage].legendServer;document.getElementById('legendNetwork').textContent=translations[currentLanguage].legendNetwork;document.getElementById('legendConnection').textContent=translations[currentLanguage].legendConnection;document.getElementById('legendRoute').textContent=translations[currentLanguage].legendRoute;document.getElementById('exportConfig').textContent=translations[currentLanguage].exportConfig;document.getElementById('importConfigBtn').textContent=translations[currentLanguage].importConfig;document.getElementById('editModalTitle').textContent=translations[currentLanguage].editModalTitle;document.getElementById('saveChanges').textContent=translations[currentLanguage].saveChanges;const devices=document.querySelectorAll('.device-input');devices.forEach(device=>{device.querySelector('h3').textContent=`${translations[currentLanguage].device} ${device.querySelector('h3').textContent.split(' ').pop()}`;device.querySelector('.interfaces h4').textContent=translations[currentLanguage].interfaceSettings;device.querySelector('.routes h4').textContent=translations[currentLanguage].routeTable;device.querySelectorAll('.add-btn')[0].textContent=translations[currentLanguage].addInterface;device.querySelectorAll('.add-btn')[1].textContent=translations[currentLanguage].addRoute;device.querySelectorAll('.remove-btn').forEach(btn=>btn.textContent=translations[currentLanguage].remove)})}function toggleDarkMode(){document.body.classList.toggle('dark-mode');const isDarkMode=document.body.classList.contains('dark-mode');localStorage.setItem('darkMode',isDarkMode);if(isDarkMode){darkModeToggle.checked=true}else{darkModeToggle.checked=false}}document.addEventListener('DOMContentLoaded',()=>{const savedDarkMode=localStorage.getItem('darkMode');if(savedDarkMode==='true'){document.body.classList.add('dark-mode');darkModeToggle.checked=true}});document.getElementById('showIPs').addEventListener('change',generateTopology);document.getElementById('showInterfaces').addEventListener('change',generateTopology);document.getElementById('showNetworks').addEventListener('change',generateTopology);const modal=document.getElementById("editModal");const span=document.getElementsByClassName("close")[0];const editForm=document.getElementById("editForm");const editText=document.getElementById("editText");let currentEditNode;function openEditModal(node){modal.style.display="block";editText.value=node.label;currentEditNode=node}span.onclick=function(){modal.style.display="none"};window.onclick=function(event){if(event.target==modal){modal.style.display="none"}};editForm.onsubmit=function(e){e.preventDefault();if(currentEditNode){currentEditNode.label=editText.value;network.body.data.nodes.update(currentEditNode)}modal.style.display="none"};addDevice();</script></body></html>